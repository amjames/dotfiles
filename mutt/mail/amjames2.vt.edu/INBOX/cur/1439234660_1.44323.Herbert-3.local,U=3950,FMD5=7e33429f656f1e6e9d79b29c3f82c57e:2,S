Delivered-To: amjames2@vt.edu
Received: by 10.140.25.151 with SMTP id 23csp2031355qgt;
        Mon, 10 Aug 2015 12:22:30 -0700 (PDT)
X-Received: by 10.55.27.37 with SMTP id b37mr41220649qkb.84.1439234550334;
        Mon, 10 Aug 2015 12:22:30 -0700 (PDT)
Return-Path: <andrew.m.james2+caf_=amjames2=vt.edu@gmail.com>
Received: from mr3.cc.vt.edu (mr3.cc.ipv6.vt.edu. [2001:468:c80:2105:0:2b9:e1ff:8be3])
        by mx.google.com with ESMTPS id 101si35168062qkv.53.2015.08.10.12.22.30
        for <amjames2@vt.edu>
        (version=TLSv1.2 cipher=ECDHE-RSA-AES128-GCM-SHA256 bits=128/128);
        Mon, 10 Aug 2015 12:22:30 -0700 (PDT)
Received-SPF: pass (google.com: domain of andrew.m.james2+caf_=amjames2=vt.edu@gmail.com designates 209.85.213.169 as permitted sender) client-ip=209.85.213.169;
Authentication-Results: mx.google.com;
       spf=pass (google.com: domain of andrew.m.james2+caf_=amjames2=vt.edu@gmail.com designates 209.85.213.169 as permitted sender) smtp.mail=andrew.m.james2+caf_=amjames2=vt.edu@gmail.com
Authentication-Results: spf=none (sender IP is )
 smtp.mailfrom=jerome.gonthier@chemistry.gatech.edu;
Received: from mail-ig0-f169.google.com (mail-ig0-f169.google.com [209.85.213.169])
	by mr3.cc.vt.edu (8.14.4/8.14.4) with ESMTP id t7AJMOCQ030750
	for <amjames2@vt.edu>; Mon, 10 Aug 2015 15:22:29 -0400
Received: by igbij6 with SMTP id ij6so76306872igb.1
        for <amjames2@vt.edu>; Mon, 10 Aug 2015 12:22:24 -0700 (PDT)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=1e100.net; s=20130820;
        h=x-original-authentication-results:delivered-to:from:to:cc:subject
         :thread-topic:thread-index:date:message-id:references:in-reply-to
         :accept-language:content-language:spamdiagnosticoutput
         :spamdiagnosticmetadata:content-type:mime-version;
        bh=24fRFM2C1uKpKyRQERqvgzlSVAEV5b1kFhcP4XTjg88=;
        b=BhDkNmZwErhYkfZfGHGWImrFgcRCbDN3ToFK7gvy6SG0d6v58gCSPKuY4HKzWRA+BV
         WZtdN04t6ILDexs4Dd9iTvv+WSHCVM7+3i4eFgQE1tNDlDD9CLs2xCSNLWOoANMhjF7R
         vT40KOYGYp0sjtv9SNkgqNNSST/L5INYMFXWGcm5PBvMFXaei4k/jGnA69PoWqF/OfTo
         M2w01PWnrT475u6bWy6gBiEW0BPQJIlTQ0T64yBGiyoGhy3e+WYEUSqLgrVepasM4ZEq
         Wo/WZ/C3A5O4Wy5ZGlMleha/z9FoM3F1zTGvYvPZpIjwFDadA4IoNIDIIxbRqLvOsWRW
         ENmw==
X-Original-Authentication-Results: mx.google.com;       spf=neutral (google.com: 65.55.169.137 is neither permitted nor denied by best guess record for domain of jerome.gonthier@chemistry.gatech.edu) smtp.mail=jerome.gonthier@chemistry.gatech.edu
X-Received: by 10.50.112.166 with SMTP id ir6mr9127797igb.75.1439234544364;
        Mon, 10 Aug 2015 12:22:24 -0700 (PDT)
X-Forwarded-To: amjames2@vt.edu
X-Forwarded-For: andrew.m.james2@gmail.com amjames2@vt.edu
Delivered-To: andrew.m.james2@gmail.com
Received: by 10.64.19.209 with SMTP id h17csp2076021iee;
        Mon, 10 Aug 2015 12:22:23 -0700 (PDT)
X-Received: by 10.60.84.143 with SMTP id z15mr20735398oey.55.1439234543457;
        Mon, 10 Aug 2015 12:22:23 -0700 (PDT)
Received: from na01-bl2-obe.outbound.protection.outlook.com (mail-bl2on0137.outbound.protection.outlook.com. [65.55.169.137])
        by mx.google.com with ESMTPS id h2si15041112obx.25.2015.08.10.12.22.22
        for <andrew.m.james2@gmail.com>
        (version=TLSv1.2 cipher=ECDHE-RSA-AES128-SHA bits=128/128);
        Mon, 10 Aug 2015 12:22:23 -0700 (PDT)
Received-SPF: neutral (google.com: 65.55.169.137 is neither permitted nor denied by best guess record for domain of jerome.gonthier@chemistry.gatech.edu) client-ip=65.55.169.137;
Received: from DM2PR0701MB1135.namprd07.prod.outlook.com (10.160.246.154) by
 DM2PR0701MB1135.namprd07.prod.outlook.com (10.160.246.154) with Microsoft
 SMTP Server (TLS) id 15.1.225.19; Mon, 10 Aug 2015 19:22:21 +0000
Received: from DM2PR0701MB1135.namprd07.prod.outlook.com ([10.160.246.154]) by
 DM2PR0701MB1135.namprd07.prod.outlook.com ([10.160.246.154]) with mapi id
 15.01.0225.018; Mon, 10 Aug 2015 19:22:21 +0000
From: "Gonthier, Jerome F" <jerome.gonthier@chemistry.gatech.edu>
To: "T. Daniel Crawford" <crawdad@vt.edu>
CC: Andrew James <andrew.m.james2@gmail.com>
Subject: Re: UHF Stability Code Again
Thread-Topic: UHF Stability Code Again
Thread-Index: AQHQ0Gi5h1eXXBqCZEGAKfZ2uTnm653/OX8AgAZnSQU=
Date: Mon, 10 Aug 2015 19:22:21 +0000
Message-ID: <DM2PR0701MB1135CC5A65AFC9F517CF4289C4700@DM2PR0701MB1135.namprd07.prod.outlook.com>
References: <CAH0V_1bgjCVJcr5KjGLML2PrHWnki0oDkd4P-6KhC0MD6Y1ZPg@mail.gmail.com>,<CAH0V_1Ze7-5Ep8CL+4EwG_vhyouVid+w12rDSDzDPPpV4ao9tQ@mail.gmail.com>
In-Reply-To: <CAH0V_1Ze7-5Ep8CL+4EwG_vhyouVid+w12rDSDzDPPpV4ao9tQ@mail.gmail.com>
Accept-Language: en-US
Content-Language: en-US
X-MS-Has-Attach:
X-MS-TNEF-Correlator:
x-originating-ip: [128.61.54.61]
x-microsoft-exchange-diagnostics: 1;DM2PR0701MB1135;5:LAa0Jz7rPleuMHnyXzWSUEZnVRThtfzLzB4kToKV0tQ/b4DW+aiMQbfgBv64vD+w5GOzXXOKfhqN0tHlVNImwEVGQB8x1FYdl+lxWDJNNc/Noxcw9V85TT3FZqfgQfo6ePKvH7K40zL7M8xMtICPzA==;24:z0PhT6yaCcsbWjyA4I+ZZLZtUKzyAO6m45TuN07gwOfG4aXrTOQ1Ea1B7yM5BCNRA2XhR1NY8Um01CP1tx8O49UeR7YUSkehH8oEwxa7mRs=;20:6yiy0i93XzF7KaH+HyETGZPdQVxnai/L16YFiJB5FpTZ0q1DukH/sEUyKO/xez1emioXlFyFJGJDEf7pXdSqIw==
x-microsoft-antispam: UriScan:;BCL:0;PCL:0;RULEID:;SRVR:DM2PR0701MB1135;
x-microsoft-antispam-prvs: <DM2PR0701MB113527661EC7FD2D73D3CF87C4700@DM2PR0701MB1135.namprd07.prod.outlook.com>
x-exchange-antispam-report-test: UriScan:;
x-exchange-antispam-report-cfa-test: BCL:0;PCL:0;RULEID:(601004)(5005006)(3002001);SRVR:DM2PR0701MB1135;BCL:0;PCL:0;RULEID:;SRVR:DM2PR0701MB1135;
x-forefront-prvs: 06640999CA
x-forefront-antispam-report: SFV:NSPM;SFS:(10019020)(377454003)(43784003)(199003)(24454002)(54094003)(189002)(5001960100002)(106116001)(110136002)(33656002)(5890100001)(16236675004)(64706001)(10400500002)(74316001)(68736005)(122556002)(5002640100001)(102836002)(46102003)(77096005)(2900100001)(66066001)(75432002)(2950100001)(99286002)(81156007)(105586002)(5001860100001)(97736004)(54356999)(101416001)(189998001)(5001830100001)(4001540100001)(76176999)(92566002)(76576001)(50986999)(2171001)(5003600100002)(77156002)(62966003)(106356001)(19580395003)(88552001)(19580405001)(19625215002)(2656002)(86362001)(89122001)(19627405001)(87936001)(40100003);DIR:OUT;SFP:1102;SCL:1;SRVR:DM2PR0701MB1135;H:DM2PR0701MB1135.namprd07.prod.outlook.com;FPR:;SPF:None;PTR:InfoNoRecords;A:1;MX:1;LANG:en;
received-spf: None (protection.outlook.com: chemistry.gatech.edu does not
 designate permitted sender hosts)
spamdiagnosticoutput: 1:23
spamdiagnosticmetadata: NSPM
Content-Type: multipart/alternative;
	boundary="_000_DM2PR0701MB1135CC5A65AFC9F517CF4289C4700DM2PR0701MB1135_"
MIME-Version: 1.0
X-OriginatorOrg: chemistry.gatech.edu
X-MS-Exchange-CrossTenant-originalarrivaltime: 10 Aug 2015 19:22:21.0480
 (UTC)
X-MS-Exchange-CrossTenant-fromentityheader: Hosted
X-MS-Exchange-CrossTenant-id: 482198bb-ae7b-4b25-8b7a-6d7f32faa083
X-MS-Exchange-Transport-CrossTenantHeadersStamped: DM2PR0701MB1135
X-Spam-Status: No, score=-0.7 required=5.0 tests=HTML_MESSAGE,
	RCVD_IN_DNSWL_LOW autolearn=disabled version=3.3.1
X-Spam-Checker-Version: SpamAssassin 3.3.1 (2010-03-16) on mr3.cc.vt.edu
X-Gm-Spam: 0
X-Gm-Phishy: 0
X-Gm-Spam: 0
X-Gm-Phishy: 0

--_000_DM2PR0701MB1135CC5A65AFC9F517CF4289C4700DM2PR0701MB1135_
Content-Type: text/plain; charset="iso-8859-1"
Content-Transfer-Encoding: quoted-printable

Hi Daniel,


so, I misunderstood you and I thought that the SCF had convergence problems=
, and not the DLU solver. I think the best keyword for the DLU solver is


solver_max_subspace


the default is at 6, I think... It may be too low, I am still playing with =
the parameters a bit. Setting it to 12 converges the 2 lowest roots. Settin=
g it to 20 will further decrease the number of iterations, but iterations w=
ith a large subspace cost more.


With your test case, solver_max_subspace 12 converges in 88 iterations. I m=
ay set the default at one root only, it should not be a problem as long as =
several guess vectors are used, which is the default. (If not, the solver c=
ould get stuck on a higher root).


For the CC question, it would be helpful to see your input file. Do you spe=
cify scf_type ? If not, I'm afraid PSI4 defaults to DF for the scf, and to =
PK for CC. So if you have:


energy('scf') <- this is going to use DF


energy('ccsd') <- this is going to use PK, and to redo an SCF before the CC=
 computation.


Does this help ?


Thanks again for being a de facto tester of my code. I am currently trying =
to finish the documentation, which will probably help.


Cheers,


J=E9r=F4me


________________________________
From: T. Daniel Crawford <crawdad@vt.edu>
Sent: Thursday, August 6, 2015 1:27 PM
To: Gonthier, Jerome F
Cc: Andrew James
Subject: Re: UHF Stability Code Again

Hi, Jerome,

I can get convergence if I set solver_n_root =3D 1 (since I really only wan=
t the lowest root anyway).  I wonder if such tight default convergence (10^=
-6) is necessary for most stability analyses?

However, I have another question about UHF stability analysis when coupled =
to subsequent CC calculations.  Why does the stability code switch over to =
PK integrals in such cases?  The SCF code runs DF-UHF to get a good guess, =
then computes and stores the JK integrals to solve the UHF equations.  Then=
 the stability code calls the PK integral algorithm (including transformati=
on) to do its analysis.  Do correlated calculations following stability ana=
lysis require the PK-based stability algorithm?

-TDC



--
Prof. T. Daniel Crawford
crawdad@vt.edu<mailto:crawdad@vt.edu>

On Thu, Aug 6, 2015 at 10:55 AM, T. Daniel Crawford <crawdad@vt.edu<mailto:=
crawdad@vt.edu>> wrote:
Hi, Jerome,

I thought that everything was working with the UHF stability code, but it s=
eems there are still convergence problems.  Can you take a look at the atta=
ched test case and give me suggestions for parameters to get it to converge=
 on the second pass?

Thanks!

-TDC
--
Prof. T. Daniel Crawford
crawdad@vt.edu<mailto:crawdad@vt.edu>


--_000_DM2PR0701MB1135CC5A65AFC9F517CF4289C4700DM2PR0701MB1135_
Content-Type: text/html; charset="iso-8859-1"
Content-Transfer-Encoding: quoted-printable

<html>
<head>
<meta http-equiv=3D"Content-Type" content=3D"text/html; charset=3Diso-8859-=
1">
<style type=3D"text/css" style=3D"display:none;"><!-- P {margin-top:0;margi=
n-bottom:0;} --></style>
</head>
<body dir=3D"ltr">
<div id=3D"divtagdefaultwrapper" style=3D"font-size:12pt;color:#000000;back=
ground-color:#FFFFFF;font-family:Calibri,Arial,Helvetica,sans-serif;">
<p>Hi Daniel,</p>
<p><br>
</p>
<p>so, I misunderstood you and I thought that the SCF had convergence probl=
ems, and not the DLU solver. I think the best keyword for the DLU solver is=
</p>
<p><br>
</p>
<p>solver_max_subspace&nbsp;</p>
<p><br>
</p>
<p>the default is at 6, I think... It may be too low, I am still playing wi=
th the parameters a bit. Setting it to 12 converges the 2 lowest roots. Set=
ting it to 20 will further decrease the number of iterations, but iteration=
s with a large subspace cost more.</p>
<p><br>
</p>
<p>With your test case, solver_max_subspace 12 converges in 88 iterations. =
I may set the default at one root only, it should not be a problem as long =
as several guess vectors are used, which is the default. (If not, the solve=
r could get stuck on a higher root).</p>
<p><br>
</p>
<p>For the CC question, it would be helpful to see your input file. Do you =
specify scf_type ? If not, I'm afraid PSI4 defaults to DF for the scf, and =
to PK for CC. So if you have:</p>
<p><br>
</p>
<p>energy('scf') &lt;- this is going to use DF</p>
<p><br>
</p>
<p>energy('ccsd') &lt;- this is going to use PK, and to redo an SCF before =
the CC computation.</p>
<p><br>
</p>
<p>Does this help ?</p>
<p><br>
</p>
<p>Thanks again for being a de facto tester of my code. I am currently tryi=
ng to finish the documentation, which will probably help.</p>
<p><br>
</p>
<p>Cheers,</p>
<p><br>
</p>
<p>J=E9r=F4me<br>
</p>
<br>
<br>
<div style=3D"color: rgb(24, 22, 21);">
<hr tabindex=3D"-1" style=3D"display:inline-block; width:98%">
<div id=3D"divRplyFwdMsg" dir=3D"ltr"><font style=3D"font-size:11pt" color=
=3D"#000000" face=3D"Calibri, sans-serif"><b>From:</b> T. Daniel Crawford &=
lt;crawdad@vt.edu&gt;<br>
<b>Sent:</b> Thursday, August 6, 2015 1:27 PM<br>
<b>To:</b> Gonthier, Jerome F<br>
<b>Cc:</b> Andrew James<br>
<b>Subject:</b> Re: UHF Stability Code Again</font>
<div>&nbsp;</div>
</div>
<div>
<div dir=3D"ltr">Hi, Jerome,
<div><br>
</div>
<div>I can get convergence if I set solver_n_root =3D 1 (since I really onl=
y want the lowest root anyway).&nbsp; I wonder if such tight default conver=
gence (10^-6) is necessary for most stability analyses? &nbsp;</div>
<div><br>
</div>
<div>However, I have another question about UHF stability analysis when cou=
pled to subsequent CC calculations.&nbsp; Why does the stability code switc=
h over to PK integrals in such cases?&nbsp; The SCF code runs DF-UHF to get=
 a good guess, then computes and stores the
 JK integrals to solve the UHF equations.&nbsp; Then the stability code cal=
ls the PK integral algorithm (including transformation) to do its analysis.=
&nbsp; Do correlated calculations following stability analysis require the =
PK-based stability algorithm?</div>
<div><br>
</div>
<div>-TDC</div>
<div><br>
</div>
<div><br>
</div>
</div>
<div class=3D"gmail_extra"><br clear=3D"all">
<div>
<div class=3D"gmail_signature">
<div dir=3D"ltr">--
<div>Prof. T. Daniel Crawford</div>
<div><a href=3D"mailto:crawdad@vt.edu" target=3D"_blank">crawdad@vt.edu</a>=
</div>
</div>
</div>
</div>
<br>
<div class=3D"gmail_quote">On Thu, Aug 6, 2015 at 10:55 AM, T. Daniel Crawf=
ord <span dir=3D"ltr">
&lt;<a href=3D"mailto:crawdad@vt.edu" target=3D"_blank">crawdad@vt.edu</a>&=
gt;</span> wrote:<br>
<blockquote class=3D"gmail_quote" style=3D"margin:0 0 0 .8ex; border-left:1=
px #ccc solid; padding-left:1ex">
<div dir=3D"ltr">Hi, Jerome,
<div><br>
</div>
<div>I thought that everything was working with the UHF stability code, but=
 it seems there are still convergence problems.&nbsp; Can you take a look a=
t the attached test case and give me suggestions for parameters to get it t=
o converge on the second pass?</div>
<div><br>
</div>
<div>Thanks!</div>
<div><br>
</div>
<div>-TDC<br clear=3D"all">
<div>
<div>
<div dir=3D"ltr">--
<div>Prof. T. Daniel Crawford</div>
<div><a href=3D"mailto:crawdad@vt.edu" target=3D"_blank">crawdad@vt.edu</a>=
</div>
</div>
</div>
</div>
</div>
</div>
</blockquote>
</div>
<br>
</div>
</div>
</div>
</div>
</body>
</html>

--_000_DM2PR0701MB1135CC5A65AFC9F517CF4289C4700DM2PR0701MB1135_--
