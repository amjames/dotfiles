Delivered-To: amjames2@vt.edu
Received: by 10.140.25.151 with SMTP id 23csp746329qgt;
        Wed, 5 Aug 2015 21:12:17 -0700 (PDT)
X-Received: by 10.140.20.115 with SMTP id 106mr23052441qgi.87.1438834337090;
        Wed, 05 Aug 2015 21:12:17 -0700 (PDT)
Return-Path: <crawdad@vt.edu>
Received: from mr5.cc.vt.edu (mr5.cc.ipv6.vt.edu. [2001:468:c80:2105:0:2b8:b328:9234])
        by mx.google.com with ESMTPS id p105si9614545qgd.86.2015.08.05.21.12.16
        for <amjames2@vt.edu>
        (version=TLSv1.2 cipher=ECDHE-RSA-AES128-GCM-SHA256 bits=128/128);
        Wed, 05 Aug 2015 21:12:17 -0700 (PDT)
Received-SPF: softfail (google.com: domain of transitioning crawdad@vt.edu does not designate 209.85.213.181 as permitted sender) client-ip=209.85.213.181;
Authentication-Results: mx.google.com;
       spf=softfail (google.com: domain of transitioning crawdad@vt.edu does not designate 209.85.213.181 as permitted sender) smtp.mail=crawdad@vt.edu
Received: from mail-ig0-f181.google.com (mail-ig0-f181.google.com [209.85.213.181])
	by mr5.cc.vt.edu (8.14.4/8.14.4) with ESMTP id t764CBmb026996
	for <amjames2@vt.edu>; Thu, 6 Aug 2015 00:12:16 -0400
Received: by igr7 with SMTP id 7so3733407igr.0
        for <amjames2@vt.edu>; Wed, 05 Aug 2015 21:12:11 -0700 (PDT)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=1e100.net; s=20130820;
        h=x-gm-message-state:mime-version:in-reply-to:references:date
         :message-id:subject:from:to:content-type;
        bh=QjAjYayEhkW2G+OtiSaKOhHxYib0Mc+o07UgMkwUvAY=;
        b=lsR6c4UjKT0K+XHUyvQHuzWdVTYR4tHjYqKpd6faLNVHR9HHBSlQMojaYpStWDhMgC
         Tl3iDmqsiQ/ojUaUsldGgwsPh0sQgXaMpcA0MNhBx3/G+CZxcmfUBYFiM1JnDwrBfq+j
         9OQinfx4XqY9EvymB/MBym07QgKfz06v/cD9zVwMpLVBGiIDbDE6GJ3ajTPEgkfIvzQU
         KX6sckFsMrVnacL+GYLfueR2pl4SIHZzcpS+xqXfu1CgnpHSCiiZHGPNr77QCufVCnsB
         tIB4ap9tV7trJNFnvowWwkoNIhUc311Qmvu6DRabvTnd7S7a20fk0l08fb/IdwEEk7nV
         P6Fg==
X-Gm-Message-State: ALoCoQkdzVixHmZO6kPhq9Ps8t/hVNIA3n2JAhBCDQAmjLgXECxwZOcGoIt9tfrLDyj2MbTLvTPc9CQzrDuOT6lpxU/qEkpjpSfJerPltL7dJsFjNjfCX2xmfHUC28lRy2HrvTsUNGfRp+fykDRodk3I0z7mxhFCvw==
X-Received: by 10.50.8.39 with SMTP id o7mr1188306iga.23.1438834330960;
        Wed, 05 Aug 2015 21:12:10 -0700 (PDT)
MIME-Version: 1.0
X-Received: by 10.50.8.39 with SMTP id o7mr1188302iga.23.1438834330781; Wed,
 05 Aug 2015 21:12:10 -0700 (PDT)
Received: by 10.107.55.87 with HTTP; Wed, 5 Aug 2015 21:12:10 -0700 (PDT)
In-Reply-To: <CAH0V_1aWxGs0gbYxf6KE=9WG6NW7keEM6Z6oeK2Z+kbypvrzVg@mail.gmail.com>
References: <CAH0V_1YdG=91KpY2n-6r3ioFHBp8-P-4agm7YVLJBm=KnV3SUw@mail.gmail.com>
	<20150805113209.GA42426@Herbert-3.local>
	<CAH0V_1ZQYBiEDbK2SWAnz+4wT5hg7apAUgj9wj8cK6=6fLbRsw@mail.gmail.com>
	<20150805145927.GA45495@Herbert-3.local>
	<CAH0V_1aWxGs0gbYxf6KE=9WG6NW7keEM6Z6oeK2Z+kbypvrzVg@mail.gmail.com>
Date: Wed, 5 Aug 2015 22:12:10 -0600
Message-ID: <CAH0V_1Zoy_0wF4-QSS=Qwqhas2e7asOuTf8XJiecH-LKp8zqJA@mail.gmail.com>
Subject: Re: Polyradicals
From: "T. Daniel Crawford" <crawdad@vt.edu>
To: Andrew M James <amjames2@vt.edu>
Content-Type: multipart/alternative; boundary=089e011840222d5d24051c9cb974
X-Spam-Status: No, score=-0.7 required=5.0 tests=HTML_MESSAGE,
	RCVD_IN_DNSWL_LOW autolearn=disabled version=3.3.1
X-Spam-Checker-Version: SpamAssassin 3.3.1 (2010-03-16) on mr5.cc.vt.edu
X-Gm-Spam: 0
X-Gm-Phishy: 0
X-Gm-Spam: 0
X-Gm-Phishy: 0

--089e011840222d5d24051c9cb974
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

Hi, AJ,

I looked back at the papers you sent =E2=80=93 especially the Pulay paper =
=E2=80=93 and
decided to implement Eq. (3) myself, and I was able to match Gaussian's UHF
NOs for a small NO radical test case!  :) You don't need to spin-project
the UHF density beforehand, but you do need the total UHF density (sum of
alpha and beta densities).  I put everything into a plugin that you can
clone from here:

git@github.com:lothian/uhfno.git

That should help us make rapid progress implementing the calculation in the
production-level UHF code. Let me know if you want to discuss it further.

-TDC

--
Prof. T. Daniel Crawford
crawdad@vt.edu

On Wed, Aug 5, 2015 at 9:03 AM, T. Daniel Crawford <crawdad@vt.edu> wrote:

> The references you sent me before and the Pulay paper discuss spin
> projection.  There is also some background material on <S^2> values of UH=
F
> wave functions in Szabo and Ostlund, and papers by Berny Schlegel discuss
> constructing projected UHF densities and energies.
>
> -TDC
>
> --
> Prof. T. Daniel Crawford
> crawdad@vt.edu
>
> On Wed, Aug 5, 2015 at 8:59 AM, Andrew M James <amjames2@vt.edu> wrote:
>
>> Hello,
>>
>>     Yes it was as if Prof. Lischka could read my mind!
>>
>>     I have been trying very hard to work through the Pulay paper, but I
>>     still can't figure out how do the projection or if it needs to be
>>     done.
>>
>>     Then says that finding the UHF NOs is simple and gives Eq 3.  So, I
>>     have been trying to find the UHF NOs by:
>>     1) building S^(1/2),
>>     2) computing S^(1/2)DS^(1/2)
>>     3) diagonalizing (2)
>>     4) the eigenvalues should be the NO occupation numbers?
>>
>>     I put a ? after 4 because that is where I find occupation numbers
>>     that make no sense. Pulay says that the projection only changes the
>>     occupation numbers, so I thought something needed to be done after I
>>     had computed the NOs this way.
>>
>>     How do I do a spin projection of the UHF wave function?
>>
>>     --AJ
>>
>
>

--089e011840222d5d24051c9cb974
Content-Type: text/html; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

<div dir=3D"ltr">Hi, AJ,<div><br></div><div>I looked back at the papers you=
 sent =E2=80=93 especially the Pulay paper =E2=80=93 and decided to impleme=
nt Eq. (3) myself, and I was able to match Gaussian&#39;s UHF NOs for a sma=
ll NO radical test case! =C2=A0:) You don&#39;t need to spin-project the UH=
F density beforehand, but you do need the total UHF density (sum of alpha a=
nd beta densities).=C2=A0 I put everything into a plugin that you can clone=
 from here:</div><div><br></div><div>git@github.com:lothian/uhfno.git<br></=
div><div><br></div><div>That should help us make rapid progress implementin=
g the calculation in the production-level UHF code. Let me know if you want=
 to discuss it further.</div><div><br></div><div>-TDC</div></div><div class=
=3D"gmail_extra"><br clear=3D"all"><div><div class=3D"gmail_signature"><div=
 dir=3D"ltr">--<div>Prof. T. Daniel Crawford</div><div><a href=3D"mailto:cr=
awdad@vt.edu" target=3D"_blank">crawdad@vt.edu</a></div></div></div></div>
<br><div class=3D"gmail_quote">On Wed, Aug 5, 2015 at 9:03 AM, T. Daniel Cr=
awford <span dir=3D"ltr">&lt;<a href=3D"mailto:crawdad@vt.edu" target=3D"_b=
lank">crawdad@vt.edu</a>&gt;</span> wrote:<br><blockquote class=3D"gmail_qu=
ote" style=3D"margin:0 0 0 .8ex;border-left:1px #ccc solid;padding-left:1ex=
"><div dir=3D"ltr">The references you sent me before and the Pulay paper di=
scuss spin projection.=C2=A0 There is also some background material on &lt;=
S^2&gt; values of UHF wave functions in Szabo and Ostlund, and papers by Be=
rny Schlegel discuss constructing projected UHF densities and energies. =C2=
=A0<span class=3D"HOEnZb"><font color=3D"#888888"><div><br></div><div>-TDC<=
/div></font></span></div><div class=3D"gmail_extra"><span class=3D""><br cl=
ear=3D"all"><div><div><div dir=3D"ltr">--<div>Prof. T. Daniel Crawford</div=
><div><a href=3D"mailto:crawdad@vt.edu" target=3D"_blank">crawdad@vt.edu</a=
></div></div></div></div>
<br></span><div><div class=3D"h5"><div class=3D"gmail_quote">On Wed, Aug 5,=
 2015 at 8:59 AM, Andrew M James <span dir=3D"ltr">&lt;<a href=3D"mailto:am=
james2@vt.edu" target=3D"_blank">amjames2@vt.edu</a>&gt;</span> wrote:<br><=
blockquote class=3D"gmail_quote" style=3D"margin:0 0 0 .8ex;border-left:1px=
 #ccc solid;padding-left:1ex">Hello,<br>
<br>
=C2=A0 =C2=A0 Yes it was as if Prof. Lischka could read my mind!<br>
<br>
=C2=A0 =C2=A0 I have been trying very hard to work through the Pulay paper,=
 but I<br>
=C2=A0 =C2=A0 still can&#39;t figure out how do the projection or if it nee=
ds to be<br>
=C2=A0 =C2=A0 done.<br>
<br>
=C2=A0 =C2=A0 Then says that finding the UHF NOs is simple and gives Eq 3.=
=C2=A0 So, I<br>
=C2=A0 =C2=A0 have been trying to find the UHF NOs by:<br>
=C2=A0 =C2=A0 1) building S^(1/2),<br>
=C2=A0 =C2=A0 2) computing S^(1/2)DS^(1/2)<br>
=C2=A0 =C2=A0 3) diagonalizing (2)<br>
=C2=A0 =C2=A0 4) the eigenvalues should be the NO occupation numbers?<br>
<br>
=C2=A0 =C2=A0 I put a ? after 4 because that is where I find occupation num=
bers<br>
=C2=A0 =C2=A0 that make no sense. Pulay says that the projection only chang=
es the<br>
=C2=A0 =C2=A0 occupation numbers, so I thought something needed to be done =
after I<br>
=C2=A0 =C2=A0 had computed the NOs this way.<br>
<br>
=C2=A0 =C2=A0 How do I do a spin projection of the UHF wave function?<br>
<span><font color=3D"#888888"><br>
=C2=A0 =C2=A0 --AJ<br>
</font></span></blockquote></div><br></div></div></div>
</blockquote></div><br></div>

--089e011840222d5d24051c9cb974--
